<style>
    .map-container {
        width: 100%;
        max-width: 800px;
        margin: 0 auto;
    }

    svg {
        width: 100%;
        height: auto;
    }

    .region {
        cursor: pointer;
        transition: fill 0.3s, transform 0.3s; /* Thêm transition cho transform */
    }

        .region:hover {
            fill: #ffcc00 !important; /* Màu khi hover */
            transform: translate(2px, 2px); /* Dịch chuyển nhẹ 2px theo cả trục x và y */
        }
</style>
<div class="map-container mt-4">
    <svg id="map" viewBox="0 0 800 800">
        <!-- Các path sẽ được thêm bằng JavaScript -->
    </svg>
</div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<!-- Sử dụng type="module" -->
<script type="module">
    import { mapRegions } from '/js/mapData.js'; // Điều chỉnh đường dẫn nếu cần

    const svg = document.getElementById('map');
    const baseUrl = '/api/Region';

    mapRegions.forEach(region => {
        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        path.setAttribute('id', region.id);
        path.setAttribute('d', region.path);
        path.setAttribute('fill', region.fill);
        path.setAttribute('stroke', region.stroke);
        path.setAttribute('stroke-width', region.strokeWidth);
        path.classList.add('region');

        const title = document.createElementNS('http://www.w3.org/2000/svg', 'title');
        title.textContent = region.name;
        path.appendChild(title);

        path.addEventListener('click', async () => {
            try {
                const response = await fetch(baseUrl + region.link);
                if (response.ok) {
                    window.location.href = 'Region'+region.link;
                } else if (response.status === 503) {
                    showUpdateMessage(region.name);
                } else {
                    alert("Không tìm thấy khu vực này!");
                }
            } catch (error) {
                console.error("Lỗi khi gọi API:", error);
                alert("Lỗi hệ thống. Vui lòng thử lại sau.");
            }
        });

        svg.appendChild(path);
    });

    function showUpdateMessage(regionName) {
        const container = document.createElement('div');
        container.className = 'container-fluid error-container';
        container.innerHTML = `
            <div class="row vh-100 align-items-center justify-content-center">
                <div class="col-md-8 text-center error-content">
                    <div class="error-card bg-dark p-5 rounded-4 shadow">
                        <div class="error-icon mb-3">
                            <i class="bi bi-exclamation-circle text-warning" style="font-size: 4rem;"></i>
                        </div>
                        <h1 class="display-5 fw-bold text-white mb-3">${regionName}</h1>
                        <h2 class="mb-3 text-white">Đang cập nhật</h2>
                        <p class="lead mb-4 text-white">Thông tin khu vực này hiện đang được cập nhật. Vui lòng quay lại sau.</p>
                        <a class="btn btn-light" href="/">Quay về trang chủ</a>
                    </div>
                </div>
            </div>
        `;
        document.body.innerHTML = ''; // Xóa bản đồ
        document.body.appendChild(container);
    }
</script>
